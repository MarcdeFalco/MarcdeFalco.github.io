<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="generator" content="pandoc">
    <meta name="description" content="">
    <meta name="author" content="Marc de Falco">

    <title>Récursivité</title>

    <link rel="stylesheet" type="text/css" href="assets/semantic.min.css">
    <link href='//fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-PHZQE2FC4W"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-PHZQE2FC4W');
	</script>

    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script src="assets/semantic.min.js"></script>

    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script>
$(document).ready(function() {
    
    $("#toc").sidebar("setting", "dimPage", false);
    $("#toc").sidebar("setting", "delaySetup", true);

    if (matchMedia) {
        var mq = window.matchMedia("(max-width: 900px)");
        mq.addListener(big_or_small);
        big_or_small(mq);
    }

    $("[href^='#']").click(
        () => {
            if (! $("#main").hasClass('shrink')) {
	            $("#toc").sidebar("hide");
            }
        })

    function big_or_small(mq) {
        // The sidebar *pushes* the pusher, the main content, so we
        // add a class that reduces the pusher's width so the edge
        // content isn't cut off.
        if (mq.matches) {
	        $("#toc").sidebar("hide");
            $("#main").removeClass("shrink")
        } else {
            $("#toc").sidebar("show");
            $("#main").addClass("shrink");
        }
    }

    $("#sidebar-menu-button").click(function() {
        $("#toc").sidebar("show");
    }).end();

    $('.tabular.menu .item').tab({
            context: 'parent'
        });

})

function setLang(l) {
    $('.tabular.menu .item').removeClass("active")
    $('.tabular.menu .item[data-tab^="'+l+'"]').addClass("active")
    $('.code').removeClass("active")
    $('.code[data-tab^="'+l+'"]').addClass("active")
}
</script>

  <style type="text/css">

  .ui.sidebar {
    font-size: 15px;
  }

  body {
    background-color: #FFFFFF;
    font-size: 20px;
  }
  .ui.segment {
    font-size: 20px;
  }
  .wireframe {
    //margin-top: 2em;
  }
  .ui.footer.segment {
    //margin: 5em 0em 0em;
    //padding: 5em 0em;
  }
  #top-menu {
    display: none;
    }

    .message {
        color: #000 !important;
    }

.shrink {
    width: 60%;
}

.code {
    font-size: 0.8em !important;
}

table {
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 24px;
    border-spacing: 0;
    border-bottom: 2px solid black;
    border-top: 2px solid black;
}

table tr {
    display: table-row !important;
}

table th {
    padding: 3px 10px;
    background-color: white;
    border-top: none;
    border-left: none;
    border-right: none;
    border-bottom: 1px solid black;
}
table td {
    padding: 3px 10px;
    border-top: none;
    border-left: none;
    border-bottom: none;
    border-right: none;
}

  .menu .item {
      padding: .5em 1em !important;
  }

@media only screen and (max-width: 900px) {
    .ui.image, .ui.image img {
        display: block;
        width: 100%;
        height: auto;
    }

    #top-menu {
        display: block !important;
    }
}
  </style>

  </head>
  <body class="pushable class="pushable"">
<div style="display: none;">
\(
\def\N{{\mathbb{N}}}
\def\R{{\mathbb{R}}}
\def\D{{\mathbb{D}}}
\def\C{{\mathbb{C}}}
\def\Z{{\mathbb{Z}}}
\def\Q{{\mathbb{Q}}}
\def\K{{\mathbb{K}}}
\def\KX{{\mathbb{K}}[X]}
\def\U{{\mathbb{U}}}
\def\B{{\mathcal{B}}}
\newcommand\ensfonctions[2]{\mathcal{F}(#1,#2)}
\newcommand\classeck[3]{\mathcal{C}^{#1}(#2,#3)}
\newcommand\range[2]{[| #1,#2 |]}
\newcommand\mod[0]{\mathop{mod}}
\newcommand\land[0]{\mathop{land}}
\newcommand\matrices[3]{\mathcal{M}_{#1,#2}(#3)}
\newcommand\matricescarres[2]{\mathcal{M}_{#1}(#2)}
\newcommand\gln[2]{\mbox{GL}_{#1}(#2)}
\newcommand\Support[1]{\mbox{Supp}(#1)}
\newcommand\dom[0]{\mbox{dom}}
\newcommand\uniondisjointe{\sqcup}
\def\lt{<}
\def\rR{\mathcal{R}}
\newcommand\parties[1]{\mathcal{P}(#1)}
\newcommand\entiere[1]{\left\lfloor #1 \right\rfloor}
\newcommand\congru[3]{#1 = #2\ [#3]}
\newcommand\enscomp[2]{\left\{\left.\ #1\ \right|\ #2\ \right\}}
\newcommand\classe[1]{\overline{#1}}
\newcommand\classemod[2]{\overline{#1}^{[#2]}}
\newcommand\quotient[2]{#1 / #2}
\newcommand\ZnZ[1]{\quotient{\Z}{#1 \Z}}
\newcommand\card[1]{\text{Card}\ #1}
\newcommand\indic{\mathbbm{1}}
\newcommand\id{\mbox{id}}
\newcommand\Perm[1]{\mathfrak{S}_#1}
\newcommand\comb[2]{\binom{#1}{#2}}
\newcommand\tend[2]{\xrightarrow[#1 \rightarrow #2]{}}
\newcommand\limite[2]{\lim_{#1 \rightarrow #2}}
\newcommand\application[5]{\begin{array}{rcccc}
#1 & : & #2 & \mapsto & #3 \\ 
& & #4 & \mapsto & #5
\end{array}}
\)
</div>



<div class="ui vertical inverted visible fixed sidebar menu" id="toc">
    <div class="item">
    <a href="/">
        <i class="icon home"></i> Informatique en CPGE
    </a>
    </div>
    <div class="item">
        <div class="ui buttons compact">
            <button onClick="setLang('ocaml')" class="ui button compact">OCaml</button>
            <button onClick="setLang('c')" class="ui button compact">C</button>
            <button onClick="setLang('python')" class="ui button compact">Python</button>
        </div>
        <div>Langage des exemples</div>
    </div>
    <div class="item">
    <a href="#">
        Récursivité
    </a>
    </div>
<!-- FIX TOC -->
<div class="item header"> <a href="#sec:la-récursivité"><span>1</span> La récursivité</a><div class="menu"><a class="item" href="#sec:principe-et-exemples"><div class="ui label">1.1</div> Principe et exemples</a><a class="item" href="#sec:implémentation-pratique"><div class="ui label">1.2</div> Implémentation pratique</a><a class="item" href="#sec:programmer-en-récursif"><div class="ui label">1.3</div> Programmer en récursif</a><a class="item" href="#sec:récursivité-croisée"><div class="ui label">1.4</div> Récursivité croisée</a></div></div><div class="item header"> <a href="#sec:larbre-dappels"><span>2</span> L’arbre d’appels</a><div class="menu"><a class="item" href="#sec:définition"><div class="ui label">2.1</div> Définition</a><a class="item" href="#sec:complexité-en-nombre-dappels"><div class="ui label">2.2</div> Complexité en nombre d’appels</a><a class="item" href="#sec:terminaison"><div class="ui label">2.3</div> Terminaison</a></div></div><div class="item header"> <a href="#sec:récursivité-terminale"><span>3</span> Récursivité terminale</a><div class="menu"><a class="item" href="#sec:présentation"><div class="ui label">3.1</div> Présentation</a><a class="item" href="#sec:optimisation"><div class="ui label">3.2</div> Optimisation</a><a class="item" href="#sec:techniques"><div class="ui label">3.3</div> Techniques</a></div></div><div class="item header"> <a href="#sec:types-inductifs-et-induction-structurelle"><span>4</span> Types inductifs et induction structurelle</a><div class="menu"><a class="item" href="#sec:définition-naïve-des-types-inductifs"><div class="ui label">4.1</div> Définition naïve des types inductifs</a></div></div><!-- FIX TOC -->
</div>

<div class="pusher" id="main-content">
    <div class="ui inverted top menu" id="top-menu">
        <div class="ui container">
	  <a class="launch icon item" id="sidebar-menu-button">
	    <i class="angle double left icon"></i>
	  </a>
	  <div class="item">
          Récursivité
	  </div>
        </div>
      </div>
      <div class="ui padded basic segment shrink" id="main">
          <!-- <div class="masthead"> -->
<div class="segment">
<div class="ui container text">
<p><div class="ui image fluid">   <div class="ui inverted active dimmer">   <div class="content">     <h1 class="ui header" style="color:black; font-size: 4rem" >     Récursivité     </h1>   </div>   </div>   <img class="" src="assets/pics/chap_recursivite.jpeg"> </div></p>
<p><em>Source de l’image d’en-tête : Paul Noth.</em> <strong>À changer par une image CC</strong></p>
<p><div class="ui message blue"><div class="header">Note</div><strong>Roadmap</strong> :</p>
<ul>
<li>finir l’écriture.</div></li>
</ul>
<h1 data-number="1" id="sec:la-récursivité"><span class="header-section-number">1</span> La récursivité</h1>
<h2 data-number="1.1" id="sec:principe-et-exemples"><span class="header-section-number">1.1</span> Principe et exemples</h2>
<p>On dit qu’une fonction est récursive lorsqu’elle va s’appeler elle-même lors de son exécution. Le plus souvent, cet appel sera directement visible depuis le corps de la fonction.</p>
<p>Par exemple, la fonction <code>fact</code> suivante permettant de calculer <span class="math inline">\(n!\)</span> est récursive :</p>
<p><div>   <div class="ui top attached tabular menu code">   <a class="active item" data-tab="ocaml-38">ocaml</a>   <a class="item" data-tab="c-38">c</a>   <a class="item" data-tab="python-38">python</a> </div> <div class="ui bottom attached active tab segment code" data-tab="ocaml-38"></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="kw">rec</span> fact n =</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> n = <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">then</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> n * fact (n<span class="dv">-1</span>)</span></code></pre></div>
<p></div> <div class="ui bottom attached tab segment code" data-tab="c-38"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fact<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n <span class="op">*</span> fact<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p></div> <div class="ui bottom attached tab segment code" data-tab="python-38"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fact(n):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n <span class="op">*</span> fact(n<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<p></div> </div></p>
<p>On utilise ici un exemple mathématique pour la simplicité des fonctions écrites. En effet, on ne voit rien d’autre dans <code>fact</code> que ces appels récursifs et ils correspondent directement à la définition mathématique :</p>
<p><span class="math display">\[
n! = \begin{cases}
1 &amp; \text{ si } n = 0 \\
n \times (n-1)! &amp; \text{ sinon.}
\end{cases}
\]</span></p>
<p><div class="ui message orange"><div class="header">Remarque</div>En fait, la définition mathématique se fait plutôt en posant : <span class="math display">\[
0! = 1 \qquad
(n+1)! = (n+1) \times n!
\]</span> Donc, pour retraduire une telle définition en tant que fonction, il est souvent nécessaire de décaler les rangs.</div></p>
<p>On remarque tout de suite deux choses :</p>
<ul>
<li>il y a un valeur pour laquelle on ne fait aucun appel</li>
<li>dans les autres cas, quand on fait un appel, l’argument <span class="math inline">\(n-1\)</span> diminue strictement.</li>
</ul>
<p>Cela permet d’être sûr qu’on ne va pas s’arrêter indéfiniment. On verra dans la suite comment on peut s’en assurer pour des fonctions plus complexes.</p>
<p>Quand on évalue <code>fact 5</code> on va effectuer une série d’appels :</p>
<p><center><div class="ui image center"><img src="assets/pics/rec_appels_f5.png" /></div></center></p>
<p>Pour calculer la valeur il faut descendre le long des appels récursifs jusqu’à tomber sur un cas de base puis remonter.</p>
<h2 data-number="1.2" id="sec:implémentation-pratique"><span class="header-section-number">1.2</span> Implémentation pratique</h2>
<p>Comme on vient de le voir, pour calculer une valeur avec une fonction récursive, il est nécessaire de remonter. Pour cela, on a besoin d’interrompre l’évaluation d’une fonction le temps que l’appel récursif se termine, puis de revenir dans l’évaluation là où on en était. On parle alors de contexte d’évaluation ou contexte d’exécution pour l’information qu’il faut sauvegarder afin de reprendre là où on en était. En première approximation, on peut se dire qu’un contexte est la donnée de la position de l’instruction courante, ou de la sous-expression en train d’être évaluée si on raisonne en fonctionnel, ainsi que de l’ensemble des valeurs des variables locales. Il est donc nécessaire de sauvegarder la succession des contextes tout au long des appels récursifs.</p>
<p>On remarque que ce mécanisme est déjà présent pour n’importe quel appel de fonction. La différence principale avec la récursivité, c’est que le nombre d’appels imbriqués à tout moment du programme n’est pas borné à priori, il dépend des paramètres récursifs, et donc il ne peut être connu qu’à l’exécution. On a ainsi besoin d’un mécanisme qui permettent de stocker un nombre quelconque de contextes.</p>
<p>Pour cela, on passe par ce qu’on appelle la pile d’appels. On verra plus tard qu’elle peut être organisée de manière très efficace pour des programmes binaires, mais pour le moment, on se contente d’imaginer que cette pile est vide au début de l’evaluation, puis, à chaque appel, on <strong>empile</strong> le contexte courant, on exécute l’appel, une fois la valeur de retour obtenue, on <strong>dépile</strong> le contexte pour reprendre l’exécution là où on en était avant l’appel mais avec cette valeur de retour calculée.</p>
<h2 data-number="1.3" id="sec:programmer-en-récursif"><span class="header-section-number">1.3</span> Programmer en récursif</h2>
<h2 data-number="1.4" id="sec:récursivité-croisée"><span class="header-section-number">1.4</span> Récursivité croisée</h2>
<h1 data-number="2" id="sec:larbre-dappels"><span class="header-section-number">2</span> L’arbre d’appels</h1>
<h2 data-number="2.1" id="sec:définition"><span class="header-section-number">2.1</span> Définition</h2>
<h2 data-number="2.2" id="sec:complexité-en-nombre-dappels"><span class="header-section-number">2.2</span> Complexité en nombre d’appels</h2>
<h2 data-number="2.3" id="sec:terminaison"><span class="header-section-number">2.3</span> Terminaison</h2>
<h1 data-number="3" id="sec:récursivité-terminale"><span class="header-section-number">3</span> Récursivité terminale</h1>
<h2 data-number="3.1" id="sec:présentation"><span class="header-section-number">3.1</span> Présentation</h2>
<h2 data-number="3.2" id="sec:optimisation"><span class="header-section-number">3.2</span> Optimisation</h2>
<h2 data-number="3.3" id="sec:techniques"><span class="header-section-number">3.3</span> Techniques</h2>
<h1 data-number="4" id="sec:types-inductifs-et-induction-structurelle"><span class="header-section-number">4</span> Types inductifs et induction structurelle</h1>
<h2 data-number="4.1" id="sec:définition-naïve-des-types-inductifs"><span class="header-section-number">4.1</span> Définition naïve des types inductifs</h2>
</div>
<!-- </div> -->
</div>

<div class="ui inverted vertical footer segment">
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
Marc de Falco
</div>
  </body>
</html>
