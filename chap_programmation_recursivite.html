<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="generator" content="pandoc">
    <meta name="description" content="">
    <meta name="author" content="Marc de Falco">

    <title>Récursivité</title>

    <link rel="stylesheet" type="text/css" href="assets/semantic.min.css">
    <link href='//fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-PHZQE2FC4W"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-PHZQE2FC4W');
	</script>

    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script src="assets/semantic.min.js"></script>

    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>

<script>
$(document).ready(function() {
    
    $("#toc").sidebar("setting", "dimPage", false);
    $("#toc").sidebar("setting", "delaySetup", true);

   $('.ui.accordion').accordion();
    if (matchMedia) {
        var mq = window.matchMedia("(max-width: 900px)");
        mq.addListener(big_or_small);
        big_or_small(mq);
    }

    $("[href^='#']").click(
        () => {
            if (! $("#main").hasClass('shrink')) {
	            $("#toc").sidebar("hide");
            }
        })

    function big_or_small(mq) {
        // The sidebar *pushes* the pusher, the main content, so we
        // add a class that reduces the pusher's width so the edge
        // content isn't cut off.
        if (mq.matches) {
	        $("#toc").sidebar("hide");
            $("#main").removeClass("shrink")
        } else {
            $("#toc").sidebar("show");
            $("#main").addClass("shrink");
        }
    }

    $("#sidebar-menu-button").click(function() {
        $("#toc").sidebar("show");
    }).end();

    $('.tabular.menu .item').tab({
            context: 'parent'
        });

})

function setLang(l) {
    $('.tabular.menu .item').removeClass("active")
    $('.tabular.menu .item[data-tab^="'+l+'"]').addClass("active")
    $('.code').removeClass("active")
    $('.code[data-tab^="'+l+'"]').addClass("active")
}
</script>

<style type="text/css">
  .ui.sidebar {
    font-size: 15px;
  }

  body {
    background-color: #FFFFFF;
    font-size: 20px;
  }
  .ui.segment {
    font-size: 20px;
  }
  .wireframe {
    //margin-top: 2em;
  }
  .ui.footer.segment {
    //margin: 5em 0em 0em;
    //padding: 5em 0em;
  }
  #top-menu {
    display: none;
    }

    .message {
        color: #000 !important;
    }

.shrink {
    width: 60%;
}

.code {
    font-size: 0.8em !important;
}

table {
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 24px;
    border-spacing: 0;
    border-bottom: 2px solid black;
    border-top: 2px solid black;
}

table tr {
    display: table-row !important;
}

table th {
    padding: 3px 10px;
    background-color: white;
    border-top: none;
    border-left: none;
    border-right: none;
    border-bottom: 1px solid black;
}
table td {
    padding: 3px 10px;
    border-top: none;
    border-left: none;
    border-bottom: none;
    border-right: none;
}

.ui.styled.accordion {
    width: 100% !important;
    font-size: 1rem !important;
}

  .menu .item {
      padding: .5em 1em !important;
  }

@media only screen and (max-width: 900px) {
    .ui.image, .ui.image img {
        display: block;
        //width: 100%;
        width: auto;
        height: auto;
    }

    #top-menu {
        display: block !important;
    }
}
</style>

</head>
<body class="pushable class="pushable"">
<div style="display: none;">
\(
\def\N{{\mathbb{N}}}
\def\R{{\mathbb{R}}}
\def\D{{\mathbb{D}}}
\def\C{{\mathbb{C}}}
\def\Z{{\mathbb{Z}}}
\def\Q{{\mathbb{Q}}}
\def\K{{\mathbb{K}}}
\def\KX{{\mathbb{K}}[X]}
\def\U{{\mathbb{U}}}
\def\B{{\mathcal{B}}}
\newcommand\ensfonctions[2]{\mathcal{F}(#1,#2)}
\newcommand\classeck[3]{\mathcal{C}^{#1}(#2,#3)}
\newcommand\range[2]{[| #1,#2 |]}
\newcommand\mod[0]{\mathop{mod}}
\newcommand\land[0]{\mathop{land}}
\newcommand\matrices[3]{\mathcal{M}_{#1,#2}(#3)}
\newcommand\matricescarres[2]{\mathcal{M}_{#1}(#2)}
\newcommand\gln[2]{\mbox{GL}_{#1}(#2)}
\newcommand\Support[1]{\mbox{Supp}(#1)}
\newcommand\dom[0]{\mbox{dom}}
\newcommand\uniondisjointe{\sqcup}
\def\lt{<}
\def\rR{\mathcal{R}}
\newcommand\parties[1]{\mathcal{P}(#1)}
\newcommand\entiere[1]{\left\lfloor #1 \right\rfloor}
\newcommand\congru[3]{#1 = #2\ [#3]}
\newcommand\enscomp[2]{\left\{\left.\ #1\ \right|\ #2\ \right\}}
\newcommand\classe[1]{\overline{#1}}
\newcommand\classemod[2]{\overline{#1}^{[#2]}}
\newcommand\quotient[2]{#1 / #2}
\newcommand\ZnZ[1]{\quotient{\Z}{#1 \Z}}
\newcommand\card[1]{\text{Card}\ #1}
\newcommand\indic{\mathbbm{1}}
\newcommand\id{\mbox{id}}
\newcommand\gO{\mathcal{O}}
\newcommand\Perm[1]{\mathfrak{S}_#1}
\newcommand\comb[2]{\binom{#1}{#2}}
\newcommand\tend[2]{\xrightarrow[#1 \rightarrow #2]{}}
\newcommand\limite[2]{\lim_{#1 \rightarrow #2}}
\newcommand\application[5]{\begin{array}{rcccc}
#1 & : & #2 & \mapsto & #3 \\ 
& & #4 & \mapsto & #5
\end{array}}
\)
</div>


<div class="ui vertical inverted visible fixed sidebar menu" id="toc">
    <div class="item">
    <a href="/">
        <i class="icon home"></i> Informatique en CPGE
    </a>
    </div>
    <div class="item">
        <div class="ui buttons compact">
            <button onClick="setLang('ocaml')" class="ui button compact">OCaml</button>
            <button onClick="setLang('c')" class="ui button compact">C</button>
            <button onClick="setLang('python')" class="ui button compact">Python</button>
        </div>
        <div>Langage des exemples</div>
    </div>
    <div class="item">
    <a href="#">
        Récursivité
    </a>
    </div>
<!-- FIX TOC -->
<div class="item header"> <a href="#sec:la-récursivité"><span>1</span> La récursivité</a><div class="menu"><a class="item" href="#sec:principe-et-exemples"><div class="ui label">1.1</div> Principe et exemples</a><a class="item" href="#sec:implémentation-pratique"><div class="ui label">1.2</div> Implémentation pratique</a><div class="secondary menu"><a style="font-size:0.6em" class="item" href="#sec:que-se-passe-t-il-quand-on-appelle-une-fonction"><i class="circle icon"></i> Que se passe-t-il quand on appelle une fonction ?</a><a style="font-size:0.6em" class="item" href="#sec:un-exemple"><i class="circle icon"></i> Un exemple</a><a style="font-size:0.6em" class="item" href="#sec:pour-une-fonction-récursive"><i class="circle icon"></i> Pour une fonction récursive</a></div><a class="item" href="#sec:programmer-en-récursif"><div class="ui label">1.3</div> Programmer en récursif</a><a class="item" href="#sec:récursivité-croisée"><div class="ui label">1.4</div> Récursivité croisée</a></div></div><div class="item header"> <a href="#sec:larbre-dappels"><span>2</span> L’arbre d’appels</a><div class="menu"><a class="item" href="#sec:définition"><div class="ui label">2.1</div> Définition</a><a class="item" href="#sec:complexité-en-nombre-dappels"><div class="ui label">2.2</div> Complexité en nombre d’appels</a><a class="item" href="#sec:terminaison"><div class="ui label">2.3</div> Terminaison</a></div></div><div class="item header"> <a href="#sec:récursivité-terminale"><span>3</span> Récursivité terminale</a><div class="menu"><a class="item" href="#sec:présentation"><div class="ui label">3.1</div> Présentation</a><a class="item" href="#sec:optimisation"><div class="ui label">3.2</div> Optimisation</a><a class="item" href="#sec:techniques"><div class="ui label">3.3</div> Techniques</a></div></div><div class="item header"> <a href="#sec:types-inductifs-et-induction-structurelle"><span>4</span> Types inductifs et induction structurelle</a><div class="menu"><a class="item" href="#sec:définition-naïve-des-types-inductifs"><div class="ui label">4.1</div> Définition naïve des types inductifs</a></div></div><!-- FIX TOC -->
</div>

<div class="pusher" id="main-content">
    <div class="ui inverted top menu" id="top-menu">
        <div class="ui container">
	  <a class="launch icon item" id="sidebar-menu-button">
	    <i class="angle double left icon"></i>
	  </a>
	  <div class="item">
          Récursivité
	  </div>
        </div>
      </div>
      <div class="ui padded basic segment shrink" id="main">
          <!-- <div class="masthead"> -->
<div class="segment">
<div class="ui container text">
<p><div class="ui image fluid">   <div class="ui inverted active dimmer">   <div class="content">     <h1 class="ui header" style="color:black; font-size: 4rem" >     Récursivité     </h1>   </div>   </div>   <img class="" src="assets/pics/chap_recursivite.jpeg"> </div></p>
<p><em>Source de l’image d’en-tête : Paul Noth.</em> <strong>À changer
par une image CC</strong></p>
<p><div class="ui message blue"><div class="header">Note</div></p>
<p><strong>Roadmap</strong> :</p>
<ul>
<li>finir l’écriture.</li>
</ul>
<p></div></p>
<h1 data-number="1" id="sec:la-récursivité"><span
class="header-section-number">1</span> La récursivité</h1>
<h2 data-number="1.1" id="sec:principe-et-exemples"><span
class="header-section-number">1.1</span> Principe et exemples</h2>
<p>On dit qu’une fonction est récursive lorsqu’elle va s’appeler
elle-même lors de son exécution. Le plus souvent, cet appel sera
directement visible depuis le corps de la fonction.</p>
<p>Par exemple, la fonction <code>fact</code> suivante permettant de
calculer <span class="math inline">\(n!\)</span> est récursive :</p>
<p><div>   <div class="ui top attached tabular menu code">   <a class="active item" data-tab="ocaml-69">ocaml</a>   <a class="item" data-tab="c-69">c</a>   <a class="item" data-tab="python-69">python</a> </div> <div class="ui bottom attached active tab segment code" data-tab="ocaml-69"></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode ocaml"><code class="sourceCode ocaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="kw">rec</span> fact n =</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> n = <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">then</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span> n * fact (n<span class="dv">-1</span>)</span></code></pre></div>
<p></div> <div class="ui bottom attached tab segment code" data-tab="c-69"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fact<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n <span class="op">*</span> fact<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p></div> <div class="ui bottom attached tab segment code" data-tab="python-69"></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fact(n):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n <span class="op">*</span> fact(n<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<p></div> </div></p>
<p>On utilise ici un exemple mathématique pour la simplicité des
fonctions écrites. En effet, on ne voit rien d’autre dans
<code>fact</code> que ces appels récursifs et ils correspondent
directement à la définition mathématique :</p>
<p><span class="math display">\[
n! = \begin{cases}
1 &amp; \text{ si } n = 0 \\
n \times (n-1)! &amp; \text{ sinon.}
\end{cases}
\]</span></p>
<p><div class="ui message orange"><div class="header">Remarque</div></p>
<p>En fait, la définition mathématique se fait plutôt en posant : <span
class="math display">\[
0! = 1 \qquad
(n+1)! = (n+1) \times n!
\]</span> Donc, pour retraduire une telle définition en tant que
fonction, il est souvent nécessaire de décaler les rangs.</p>
<p></div></p>
<p>On remarque tout de suite deux choses :</p>
<ul>
<li>il y a un valeur pour laquelle on ne fait aucun appel</li>
<li>dans les autres cas, quand on fait un appel, l’argument <span
class="math inline">\(n-1\)</span> diminue strictement.</li>
</ul>
<p>Cela permet d’être sûr qu’on ne va pas s’arrêter indéfiniment. On
verra dans la suite comment on peut s’en assurer pour des fonctions plus
complexes.</p>
<p>Quand on évalue <code>fact 5</code> on va effectuer une série
d’appels :</p>
<p><center><div class="ui image center"><img
src="assets/pics/rec_appels_f5.png" /></div></center></p>
<p>Pour calculer la valeur il faut descendre le long des appels
récursifs jusqu’à tomber sur un cas de base puis remonter.</p>
<h2 data-number="1.2" id="sec:implémentation-pratique"><span
class="header-section-number">1.2</span> Implémentation pratique</h2>
<h3 data-number="1.2.1"
id="sec:que-se-passe-t-il-quand-on-appelle-une-fonction"><span
class="header-section-number">1.2.1</span> Que se passe-t-il quand on
appelle une fonction ?</h3>
<p>Le principe de définition et d’appels de fonctions est à la base de
la programmation structurée : au lieu d’avoir une longue succession
d’instructions ou d’expressions, on les regroupe au sein de fonction
pour s’organiser. Cela permet également de <em>factoriser</em> du code :
au lieu de dupliquer, on regroupe le même code au sein d’une
fonction.</p>
<p>La question qu’on se pose ici est celle du mécanisme permettant une
telle exécution du code. On pourrait naïvement penser qu’appeler une
fonction serait absolument équivalent à copier son corps :</p>
<p><div class="ui internally celled grid"><div class="row"><div class="eight wide column"></p>
<p><div class="ui segment code"></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    y <span class="op">=</span> x <span class="op">*</span> x</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>b <span class="op">=</span> f(a)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="bu">print</span>(b)</span></code></pre></div>
<p></div></p>
<p></div><div class="eight wide column"></p>
<p><div class="ui segment code"></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Début de f</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>x <span class="op">=</span> a</span>
<span id="cb5-4"><a href="#cb5-4"></a>y <span class="op">=</span> x <span class="op">*</span> x</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Fin de f et valeur de retour</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>b <span class="op">=</span> x <span class="op">+</span> y</span></code></pre></div>
<p></div></p>
<p></div></div></div></p>
<p>Au début de l’informatique, c’était effectivement la manière dont on
appelait les fonctions. Mais on peut se rendre compte facilement du
problème en changeant noms de variables :</p>
<p><div class="ui internally celled grid"><div class="row"><div class="eight wide column"></p>
<p><div class="ui segment code"></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb6-2"><a href="#cb6-2"></a>    a <span class="op">=</span> x <span class="op">*</span> x</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="cf">return</span> x <span class="op">+</span> a</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>b <span class="op">=</span> f(a)</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="bu">print</span>(b)</span></code></pre></div>
<p></div></p>
<p></div><div class="eight wide column"></p>
<p><div class="ui segment code"></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Début de f</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>x <span class="op">=</span> a</span>
<span id="cb7-4"><a href="#cb7-4"></a>a <span class="op">=</span> x <span class="op">*</span> x</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># Fin de f et valeur de retour</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>b <span class="op">=</span> x <span class="op">+</span> a</span></code></pre></div>
<p></div></p>
<p></div></div></div></p>
<p>Ici, l’appel de la fonction a changé la valeur de <code>a</code> car
<code>a</code> était aussi une variable définie dans <code>f</code>. Il
est nécessaire d’avoir un mécanisme sophistiqué permettant de
sauvegarder le contexte d’exécution d’une fonction et de le restaurer
quand l’appel à une fonction est terminé.</p>
<p>Comme les fonctions vont elles-mêmes appelés d’autres fonctions, on
ne peut pas se contenter de ne garder qu’un seul contexte. La bonne
solution est d’utiliser ce qu’on appelle une <strong>pile
d’exécution</strong>. Avant d’évaluer une fonction, on empile son
contexte sur la pile, quand elle a terminé, on le dépile. On reverra
plus tard la structure de donnée <strong>pile</strong> mais, pour le
moment, on peut se l’imaginer comme une pile d’assiettes à laver : au
départ, elle est vide. Chaque fois qu’on empile une assiette, elle
grandit. Quand on veut laver une assiette, on prend nécessairement la
dernière assiette empilée.</p>
<h3 data-number="1.2.2" id="sec:un-exemple"><span
class="header-section-number">1.2.2</span> Un exemple</h3>
<p>Si on considère le programme :</p>
<p><div class="ui segment code"></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">def</span> f():</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">def</span> g(x):</span>
<span id="cb8-5"><a href="#cb8-5"></a>    v <span class="op">=</span> x<span class="op">+</span>f()</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="cf">return</span> v</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">def</span> h(x):</span>
<span id="cb8-9"><a href="#cb8-9"></a>    v <span class="op">=</span> g(x<span class="op">+</span><span class="dv">1</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="cf">return</span> v</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>h(<span class="dv">3</span>)</span></code></pre></div>
<p></div></p>
<p>Il va s’exécuter ainsi :</p>
<ul>
<li><p>Au départ le pile d’exécution est vide :
<center><div class="ui image center"><img
src="assets/pics/pile_ex1.png" /></div></center></p></li>
<li><p>Ligne 12 : on appelle <code>h</code>, on crée donc sur la pile
une entrée pour <code>h</code>.
<center><div class="ui image center"><img
src="assets/pics/pile_ex2.png" /></div></center></p></li>
<li><p>Ligne 9 : on appelle <code>g</code> depuis <code>h</code>, on
crée donc sur la pile une entrée pour <code>g</code>. On remarque
notamment que <span class="math inline">\(x\)</span> n’aura pas le même
sens et la même valeur dans <code>g</code> que dans <code>h</code>.
<center><div class="ui image center"><img
src="assets/pics/pile_ex3.png" /></div></center></p></li>
<li><p>Ligne 5 : on appelle <code>f</code>, on crée donc sur la pile une
entrée pour <code>f</code>. <center><div class="ui image center"><img
src="assets/pics/pile_ex4.png" /></div></center></p></li>
<li><p>Ligne 2 : on sort de <code>f</code> en renvoyant la valeur 4. On
dépile ainsi l’environnement de <code>f</code>.
<center><div class="ui image center"><img
src="assets/pics/pile_ex5.png" /></div></center></p></li>
<li><p>Ligne 5 : l’environnement de <code>g</code> est modifié par la
valeur de retour de <code>f</code> qui introduit une variable
<code>v</code>. <center><div class="ui image center"><img
src="assets/pics/pile_ex6.png" /></div></center></p></li>
<li><p>Ligne 6 : on sort de <code>g</code> en renvoyant la valeur 8. On
dépile ainsi l’environnement de <code>g</code>.
<center><div class="ui image center"><img
src="assets/pics/pile_ex7.png" /></div></center></p></li>
<li><p>Ligne 9 : on définit une variable <code>v</code> locale à
<code>h</code> avec la valeur de retour de <code>g</code> :
<center><div class="ui image center"><img
src="assets/pics/pile_ex8.png" /></div></center></p></li>
<li><p>Ligne 10 : l’appel de <code>h</code> est fini, on le
dépile.</p></li>
<li><p>Ligne 12 : on a recupéré la valeur de retour 64, on l’affiche
avec un appel à <code>print</code> (qui sera aussi empilé).</p></li>
</ul>
<h3 data-number="1.2.3" id="sec:pour-une-fonction-récursive"><span
class="header-section-number">1.2.3</span> Pour une fonction
récursive</h3>
<p>Le mécanisme mis en place est suffisament robuste pour permettre à
une fonction de s’appeler elle-même. En effet, le fait d’avoir bien
separé les environnements d’exécution assure qu’il n’y aura pas de
problèmes.</p>
<p>Si on reprend l’exemple vu au dessus de l’évaluation de <span
class="math inline">\(5!\)</span>, on remarque que lorsqu’on descend le
long des appels, on empile, et lorsqu’on remonte, on dépile.</p>
<h2 data-number="1.3" id="sec:programmer-en-récursif"><span
class="header-section-number">1.3</span> Programmer en récursif</h2>
<h2 data-number="1.4" id="sec:récursivité-croisée"><span
class="header-section-number">1.4</span> Récursivité croisée</h2>
<h1 data-number="2" id="sec:larbre-dappels"><span
class="header-section-number">2</span> L’arbre d’appels</h1>
<h2 data-number="2.1" id="sec:définition"><span
class="header-section-number">2.1</span> Définition</h2>
<h2 data-number="2.2" id="sec:complexité-en-nombre-dappels"><span
class="header-section-number">2.2</span> Complexité en nombre
d’appels</h2>
<h2 data-number="2.3" id="sec:terminaison"><span
class="header-section-number">2.3</span> Terminaison</h2>
<h1 data-number="3" id="sec:récursivité-terminale"><span
class="header-section-number">3</span> Récursivité terminale</h1>
<h2 data-number="3.1" id="sec:présentation"><span
class="header-section-number">3.1</span> Présentation</h2>
<h2 data-number="3.2" id="sec:optimisation"><span
class="header-section-number">3.2</span> Optimisation</h2>
<h2 data-number="3.3" id="sec:techniques"><span
class="header-section-number">3.3</span> Techniques</h2>
<h1 data-number="4"
id="sec:types-inductifs-et-induction-structurelle"><span
class="header-section-number">4</span> Types inductifs et induction
structurelle</h1>
<h2 data-number="4.1"
id="sec:définition-naïve-des-types-inductifs"><span
class="header-section-number">4.1</span> Définition naïve des types
inductifs</h2>
</div>
<!-- </div> -->
</div>

<div class="ui inverted vertical footer segment">
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
Marc de Falco
</div>
  </body>
</html>
